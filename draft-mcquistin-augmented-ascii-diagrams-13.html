<!DOCTYPE html>
<html data-bs-theme="light" lang="en" style="--doc-ptsize-max: 12pt;"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>
            
                draft-mcquistin-augmented-ascii-diagrams-13
            
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="draft-mcquistin-augmented-ascii-diagrams-13_files/import_002.css" rel="stylesheet">
        <link href="draft-mcquistin-augmented-ascii-diagrams-13_files/import.css" rel="stylesheet">
        
            <link rel="stylesheet" href="draft-mcquistin-augmented-ascii-diagrams-13_files/document_html_referenced.css">
            
                <link rel="stylesheet" href="draft-mcquistin-augmented-ascii-diagrams-13_files/document_html_txt.css">
            
            <script type="text/javascript" async="" defer="defer" src="draft-mcquistin-augmented-ascii-diagrams-13_files/matomo.js"></script><script src="draft-mcquistin-augmented-ascii-diagrams-13_files/document_html.js"></script>
            <script src="draft-mcquistin-augmented-ascii-diagrams-13_files/theme.js"></script>
        
        <link rel="alternate" type="application/atom+xml" href="https://datatracker.ietf.org/feed/document-changes/draft-mcquistin-augmented-ascii-diagrams/" aria-label="Document changes" data-bs-original-title="Document changes">
        <meta name="description" content="Describing Protocol Data Units with Augmented Packet Header Diagrams (Internet-Draft, 2023)">
        

<link rel="apple-touch-icon" sizes="180x180" href="https://www.ietf.org/lib/dt/11.14.0/ietf/images/ietf-logo-nor-180.png">
<link rel="icon" sizes="32x32" href="https://www.ietf.org/lib/dt/11.14.0/ietf/images/ietf-logo-nor-32.png">
<link rel="icon" sizes="16x16" href="https://www.ietf.org/lib/dt/11.14.0/ietf/images/ietf-logo-nor-16.png">
<link rel="manifest" href="https://datatracker.ietf.org/site.webmanifest">
<link rel="mask-icon" href="https://www.ietf.org/lib/dt/11.14.0/ietf/images/ietf-logo-nor-mask.svg" color="#ffffff">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">
        




<meta property="og:title" content="Describing Protocol Data Units with Augmented Packet Header Diagrams">
<meta property="og:url" content="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-13">
<link rel="canonical" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-13">
<meta property="og:site_name" content="IETF Datatracker">
<meta property="og:description" content="This document describes a machine-readable format for specifying the syntax of protocol data units within a protocol specification, known as an Augmented Packet Header Diagram. This comprises a consistently formatted packet header diagram, using a well-defined syntax, that is followed by structured explanatory text. The Augmented Packet Header Diagram format is designed to maintain human readability, while also supporting automated parser generation from protocol specification documents. This document is itself an example of how the format can be used.">
<meta property="og:type" content="article">

<meta property="article:section" content="Individual Internet-Draft">

<meta property="article:author" content="Stephen McQuistin">
<meta property="article:author" content="Vivian Band">
<meta property="article:author" content="Dejice Jacob">
<meta property="article:author" content="Colin Perkins">



        
        <style>
            
            .diff-form .select2-selection__rendered {
                direction: rtl;
                text-align: left;
            }
        </style>
    </head>
    <body>
        
        <div class="btn-toolbar sidebar-toolbar position-fixed top-0 end-0 m-2 m-lg-3 d-print-none">
            <div class="dropdown">
                <button class="btn btn-outline-secondary btn-sm me-1 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" aria-label="Toggle theme">
                        <i class="theme-icon-active bi bi-circle-half"></i>
                </button>

                <ul class="dropdown-menu" aria-labelledby="bd-theme">
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                            <i class="me-2 opacity-50 theme-icon bi bi-sun-fill"></i>
                            Light<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                            <i class="me-2 opacity-50 theme-icon bi bi-moon-stars-fill"></i>
                            Dark<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                            <i class="me-2 opacity-50 theme-icon bi bi-circle-half"></i>
                            Auto<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                </ul>
            </div>
            <button class="btn btn-outline-secondary btn-sm sidebar-toggle" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar" aria-expanded="true" aria-controls="sidebar" aria-label="Toggle metadata sidebar" data-bs-original-title="Toggle metadata sidebar">
            <i class="bi bi-arrow-bar-left sidebar-shown"></i>
            <i class="bi bi-arrow-bar-right sidebar-collapsed"></i>
            </button>
        </div>
        <nav class="navbar bg-light-subtle px-1 fixed-top d-print-none d-md-none">
            <a class="nav-link ps-1" href="https://datatracker.ietf.org/doc/draft-mcquistin-augmented-ascii-diagrams/">
                
                    draft-mcquistin-augmented-ascii-diagrams-13
                
                <br class="d-sm-none">
                <span class="ms-sm-3 badge rounded-pill badge-draft">
                    
                        Internet-Draft
                    
                </span>
            </a>
            <button class="navbar-toggler p-1" type="button" data-bs-toggle="collapse" data-bs-target="#docinfo-collapse" aria-controls="docinfo-collapse" aria-expanded="false" aria-label="Show document information">
                <span class="navbar-toggler-icon small"></span>
            </button>
            <div class="navbar-nav navbar-nav-scroll overscroll-none collapse pt-1" id="docinfo-collapse">
                <div class="bg-light-subtle p-0">
                    <table class="table table-sm table-borderless small">
                        <tbody class="meta align-top">
                            <tr>
                                <th scope="row"></th>
                                <th scope="row">Title</th>
                                <td class="edit"></td>
                                <td>Describing Protocol Data Units with Augmented Packet Header Diagrams</td>
                            </tr>
                        </tbody>
                        






<tbody class="meta align-top ">
    <tr>
        <th scope="row">Document</th>
        <th scope="row">Document type</th>
        <td class="edit"></td>
        <td>
            
                
                    <span class="text-success">Active Internet-Draft</span>
                    (individual)
                    
                
            
            
        </td>
    </tr>
    
        <tr>
            <td></td>
            <th scope="row">Select version</th>
            <td class="edit"></td>
            <td>
                



    <ul class="revision-list pagination pagination-sm text-center flex-wrap my-0">
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-00">
                        00
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-01" rel="nofollow">
                        01
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-02" rel="nofollow">
                        02
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-03" rel="nofollow">
                        03
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-04" rel="nofollow">
                        04
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-05" rel="nofollow">
                        05
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-06" rel="nofollow">
                        06
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-07" rel="nofollow">
                        07
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-08" rel="nofollow">
                        08
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-09" rel="nofollow">
                        09
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-10" rel="nofollow">
                        10
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-11" rel="nofollow">
                        11
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-12" rel="nofollow">
                        12
                    </a>
                </li>
            
        
            
                <li class="page-item active">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-13">
                        13
                    </a>
                </li>
            
        
        
    </ul>

            </td>
        </tr>
        
            <tr>
                <td></td>
                <th scope="row">Compare versions</th>
                <td class="edit"></td>
                <td>
                    



<form class="form-horizontal diff-form" action="https://author-tools.ietf.org/iddiff" method="get" target="_blank">


            <select class="form-select form-select-sm mb-1 select2-field select2-hidden-accessible" data-max-entries="1" data-width="resolve" data-allow-clear="false" data-minimum-input-length="0" aria-label="From revision" name="url1" data-select2-id="select2-data-1-nidk" tabindex="-1" aria-hidden="true">
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-13">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-12" selected="selected" data-select2-id="select2-data-3-gjyy">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-11">
                        draft-mcquistin-augmented-ascii-diagrams-11
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-10">
                        draft-mcquistin-augmented-ascii-diagrams-10
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-09">
                        draft-mcquistin-augmented-ascii-diagrams-09
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-08">
                        draft-mcquistin-augmented-ascii-diagrams-08
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-07">
                        draft-mcquistin-augmented-ascii-diagrams-07
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-06">
                        draft-mcquistin-augmented-ascii-diagrams-06
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-05">
                        draft-mcquistin-augmented-ascii-diagrams-05
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-04">
                        draft-mcquistin-augmented-ascii-diagrams-04
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-03">
                        draft-mcquistin-augmented-ascii-diagrams-03
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-02">
                        draft-mcquistin-augmented-ascii-diagrams-02
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-01">
                        draft-mcquistin-augmented-ascii-diagrams-01
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-00">
                        draft-mcquistin-augmented-ascii-diagrams-00
                        
                    </option>
                
                
            </select><span class="select2 select2-container select2-container--bootstrap-5" dir="ltr" data-select2-id="select2-data-2-sner" style="width: auto;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-sm mb-1" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-url1-sy-container" aria-controls="select2-url1-sy-container"><span class="select2-selection__rendered" id="select2-url1-sy-container" role="textbox" aria-readonly="true" title="
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    ">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>

            <select class="form-select form-select-sm mb-1 select2-field select2-hidden-accessible" data-max-entries="1" data-width="resolve" data-allow-clear="false" data-minimum-input-length="0" aria-label="To revision" name="url2" data-select2-id="select2-data-4-uc2j" tabindex="-1" aria-hidden="true">
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-13" selected="selected" data-select2-id="select2-data-6-yocv">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-12">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-11">
                        draft-mcquistin-augmented-ascii-diagrams-11
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-10">
                        draft-mcquistin-augmented-ascii-diagrams-10
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-09">
                        draft-mcquistin-augmented-ascii-diagrams-09
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-08">
                        draft-mcquistin-augmented-ascii-diagrams-08
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-07">
                        draft-mcquistin-augmented-ascii-diagrams-07
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-06">
                        draft-mcquistin-augmented-ascii-diagrams-06
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-05">
                        draft-mcquistin-augmented-ascii-diagrams-05
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-04">
                        draft-mcquistin-augmented-ascii-diagrams-04
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-03">
                        draft-mcquistin-augmented-ascii-diagrams-03
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-02">
                        draft-mcquistin-augmented-ascii-diagrams-02
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-01">
                        draft-mcquistin-augmented-ascii-diagrams-01
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-00">
                        draft-mcquistin-augmented-ascii-diagrams-00
                        
                    </option>
                
                
            </select><span class="select2 select2-container select2-container--bootstrap-5" dir="ltr" data-select2-id="select2-data-5-zfyi" style="width: auto;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-sm mb-1" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-url2-nz-container" aria-controls="select2-url2-nz-container"><span class="select2-selection__rendered" id="select2-url2-nz-container" role="textbox" aria-readonly="true" title="
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    ">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>

            <button type="submit" class="btn btn-primary btn-sm" value="--html" name="difftype">
                Side-by-side
            </button>
            
            <button type="submit" class="btn btn-primary btn-sm" value="--hwdiff" name="difftype">
                Inline
            </button>


</form>
                </td>
            </tr>
        
    
    <tr>
        <td></td>
        <th scope="row">Authors</th>
        <td class="edit">
            
        </td>
        <td>
            
            
                <span><a href="https://datatracker.ietf.org/person/sm@smcquistin.uk" data-bs-original-title="Datatracker profile of Stephen McQuistin.">Stephen McQuistin</a> <a href="mailto:sm%40smcquistin.uk" aria-label="Compose email to sm@smcquistin.uk." data-bs-original-title="Compose email to sm@smcquistin.uk.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/vivianband0@gmail.com" data-bs-original-title="Datatracker profile of Vivian Band.">Vivian Band</a> <a href="mailto:vivianband0%40gmail.com" aria-label="Compose email to vivianband0@gmail.com." data-bs-original-title="Compose email to vivianband0@gmail.com.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/dejice.jacob@glasgow.ac.uk" data-bs-original-title="Datatracker profile of Dejice Jacob.">Dejice Jacob</a> <a href="mailto:dejice.jacob%40glasgow.ac.uk" aria-label="Compose email to dejice.jacob@glasgow.ac.uk." data-bs-original-title="Compose email to dejice.jacob@glasgow.ac.uk.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/csp@csperkins.org" data-bs-original-title="Datatracker profile of Colin Perkins.">Colin Perkins</a> <a href="mailto:csp%40csperkins.org" aria-label="Compose email to csp@csperkins.org." data-bs-original-title="Compose email to csp@csperkins.org.">
                <i class="bi bi-envelope"></i></a></span>
            
            
                <br>
                <a class="btn btn-primary btn-sm mt-1" href="mailto:draft-mcquistin-augmented-ascii-diagrams@ietf.org?subject=draft-mcquistin-augmented-ascii-diagrams" data-bs-original-title="Send email to the document authors">Email authors</a>
            
        </td>
    </tr>
    
    
    
    
    <tr>
        <td></td>
        <th scope="row">
            RFC stream
        </th>
        <td class="edit">
            
        </td>
        <td>
            
                
                    <a href="https://datatracker.ietf.org/stream/ise/">
                
                
                    
                        Independent Submission
                    
                
                
                    </a>
                
            
        </td>
    </tr>
    
    <tr>
        <td></td>
        <th scope="row">
            Other formats
        </th>
        <td class="edit">
        </td>
        <td>
            
                
    <div class="buttonlist">
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.txt">
            
                <i class="bi bi-file-text"></i> txt
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.html">
            
                <i class="bi bi-file-code"></i> html
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.xml">
            
                <i class="bi bi-file-code"></i> xml
            
        </a>
        
    
        
    
        
        <a class="btn btn-primary btn-sm" download="draft-mcquistin-augmented-ascii-diagrams-13.pdf" target="_blank" href="https://datatracker.ietf.org/doc/pdf/draft-mcquistin-augmented-ascii-diagrams-13">
            
                <i class="bi bi-file-pdf"></i> pdf
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://datatracker.ietf.org/doc/draft-mcquistin-augmented-ascii-diagrams/13/bibtex/">
            
                <i class="bi bi-file-ruled"></i> bibtex
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://datatracker.ietf.org/doc/bibxml3/draft-mcquistin-augmented-ascii-diagrams-13.xml">
            
                <i class="bi bi-file-code"></i> bibxml
            
        </a>
        
    
</div>

            
        </td>
    </tr>
    
    
        
    
</tbody>
                        <tbody><tr>
                            <th scope="row"></th>
                            <th scope="row"></th>
                            <td class="edit"></td>
                            <td>
                                <a class="btn btn-sm btn-warning mb-3" target="_blank" href="https://github.com/ietf-tools/datatracker/issues/new/choose">
                                    Report a bug
                                    <i class="bi bi-bug"></i>
                                </a>
                            </td>
                        </tr>
                    </tbody></table>
                </div>
            </div>
        </nav>
        <div class="row g-0">
            <div class="col-md-9 d-flex justify-content-center lh-sm" data-bs-spy="scroll" data-bs-target="#toc-nav" data-bs-smooth-scroll="true" tabindex="0" id="content">
                
                    <div class="rfchtml">
                        <br class="noprint">
                        <div class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Augmented Packet Diagrams</td>
<td class="right">October 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">McQuistin, et al.</td>
<td class="center">Expires 24 April 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mcquistin-augmented-ascii-diagrams-13</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-10-22" class="published">22 October 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-04-24">24 April 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. McQuistin</div>
<div class="org">University of St Andrews</div>
</div>
<div class="author">
      <div class="author-name">V. Band</div>
<div class="org">University of Glasgow</div>
</div>
<div class="author">
      <div class="author-name">D. Jacob</div>
<div class="org">University of Glasgow</div>
</div>
<div class="author">
      <div class="author-name">C. S. Perkins</div>
<div class="org">University of Glasgow</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Describing Protocol Data Units with Augmented Packet Header Diagrams</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
              This document describes a machine-readable format for specifying
              the syntax of protocol data units within a protocol specification,
              known as an Augmented Packet Header Diagram. This comprises a
              consistently formatted packet header diagram, using a well-defined
              syntax, that is followed by structured explanatory text. The
              Augmented Packet Header Diagram format is designed to maintain human
              readability, while also supporting automated parser generation
              from protocol specification documents. This document is itself
              an example of how the format can be used.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 April 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.&nbsp;&nbsp;<a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.&nbsp;&nbsp;<a href="#name-background" class="internal xref">Background</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.&nbsp;&nbsp;<a href="#name-limitations-of-current-pack" class="internal xref">Limitations of Current Packet Header Diagrams</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.&nbsp;&nbsp;<a href="#name-formal-languages-in-standar" class="internal xref">Formal languages in standards documents</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.&nbsp;&nbsp;<a href="#name-augmented-packet-header-dia" class="internal xref">Augmented Packet Header Diagrams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.&nbsp;&nbsp;<a href="#name-defining-protocol-data-unit" class="internal xref">Defining Protocol Data Units</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.&nbsp;&nbsp;<a href="#name-cross-referencing-previousl" class="internal xref">Cross-Referencing Previously Defined Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.&nbsp;&nbsp;<a href="#name-specifying-enumerated-types" class="internal xref">Specifying Enumerated Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.&nbsp;&nbsp;<a href="#name-splitting-fields" class="internal xref">Splitting Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.&nbsp;&nbsp;<a href="#name-extending-sub-structures" class="internal xref">Extending Sub-Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.&nbsp;&nbsp;<a href="#name-storing-data-for-parsing" class="internal xref">Storing Data for Parsing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.&nbsp;&nbsp;<a href="#name-connecting-structures-with-" class="internal xref">Connecting Structures with Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.&nbsp;&nbsp;<a href="#name-specifying-protocols" class="internal xref">Specifying Protocols</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.&nbsp;&nbsp;<a href="#name-importing-definitions-from-" class="internal xref">Importing Definitions from Other Documents</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.&nbsp;&nbsp;<a href="#name-design-principles" class="internal xref">Design Principles</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.&nbsp;&nbsp;<a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.&nbsp;&nbsp;<a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.&nbsp;&nbsp;<a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.&nbsp;&nbsp;<a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.&nbsp;&nbsp;<a href="#name-abnf-specification" class="internal xref">ABNF specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.&nbsp;&nbsp;<a href="#name-constraint-expressions" class="internal xref">Constraint Expressions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.&nbsp;&nbsp;<a href="#name-augmented-packet-diagrams" class="internal xref">Augmented packet diagrams</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.&nbsp;&nbsp;<a href="#name-tooling-source-code" class="internal xref">Tooling &amp; source code</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
                Packet header diagrams are widely used for
                describing the syntax of binary protocols. In otherwise largely textual
                documents, they allow for the visualisation of packet formats in a readily
                understandable manner, aiding the implementation of parsers for the
                protocols that they describe.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
                <a href="#tcp-header-format" class="auto internal xref">Figure 1</a> gives an example of how packet
                header diagrams are used to define binary protocol formats. The format
                has an obvious structure: the diagram clearly delineates each field,
                showing its width and its position within the header. This type of diagram is
                designed for human readers, but is consistent enough that it should
                be possible to develop a tool that generates a parser for the packet
                format from the diagram.<a href="#section-1-2" class="pilcrow">¶</a></p>
<span id="name-the-tcp-packet-header-forma"></span><div id="tcp-header-format">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-1-3.1">
<pre>:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |          Source Port          |       Destination Port        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Sequence Number                        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                    Acknowledgment Number                      |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |  Data |           |U|A|P|R|S|F|                               |
:   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |
:   |       |           |G|K|H|T|N|N|                               |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |           Checksum            |         Urgent Pointer        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                    Options                    |    Padding    |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                             data                              |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-tcp-packet-header-forma" class="selfRef">The TCP packet header format (from <em class="cite xref">[RFC793]</em>)</a>
        </figcaption></figure>
</div>
<p id="section-1-4">
                Unfortunately, the format of such packet diagrams varies both within
                and between documents in the RFC series. This variation makes it difficult to build
                tools to generate parsers from the specifications. Better tooling
                could be developed if protocol specifications adopted a consistent
                format for their packet descriptions. Indeed,
                this underpins the format described by this draft: we want to
                retain the benefits that packet header diagrams provide, while identifying
                the benefits of adopting a consistent format.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
                This document describes a consistent packet header diagram format and
                accompanying structured text phrases, collectively known as Augmented
                Packet Header Diagrams, that fully specify the syntax of protocol data
                units allowing for the automated generation of packet parsing code.
                Broad design principles, that
                maintain the primacy of human readability and flexibility in
                writing, are described, before the format itself is given.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
                This document is itself an example of the approach that it describes, with
                the packet header diagrams and structured text format described by example.
                Packet header diagrams that do not use the Augmented Packet Header Diagram
                format are marked by a colon at the beginning of each line, as in
                <a href="#tcp-header-format" class="auto internal xref">Figure 1</a>; this prevents them from
                being parsed by the accompanying tooling.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
              The goal of this document is to define a format that, with
 minimal effort on the part of authors, provides benefits to the users 
of those documents that adopt it. An explicit non-goal of this work, as 
will be further discussed in <a href="#designprinciples" class="auto internal xref">Section 4</a>,
 is to be prescriptive about how the format should be adopted. For 
example, alterations to the underlying XML format of RFCs are 
out-of-scope.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
                This draft describes early work. As consensus builds around the
                particular syntax of the format described, a formal ABNF
                specification (<a href="#ABNF" class="auto internal xref">Appendix A</a>) will be provided. Code that parses
                documents written using this format, and that automatically generates parser code for the described
                protocols, is described in <a href="#source" class="auto internal xref">Appendix B</a>.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-background">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-2-1">
                We begin by considering how packet header diagrams are currently
                used within the RFC series. This exposes the limitations that the current
                usage has in terms of machine-readability, guiding the design of the
                augmented packet header format that we propose.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
                While this document focuses on machine-readability of packet header
                diagrams, this section also discusses the use of other structured or formal
                languages within IETF documents. Considering how and why these languages
                are used provides an instructive contrast to the relatively incremental
                approach proposed here.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="background-ascii">
<section id="section-2.1">
        <h3 id="name-limitations-of-current-pack">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-limitations-of-current-pack" class="section-name selfRef">Limitations of Current Packet Header Diagrams</a>
        </h3>
<p id="section-2.1-1">
                  Packet header diagrams are frequently used in IETF standards to describe the
                  format of binary protocols. While there is no standard for how
                  these diagrams should be formatted, they have a broadly similar structure,
                  where the layout of a protocol data unit (PDU) or structure is shown in
                  diagrammatic form, followed by a description of the fields that it
                  contains. An example of this format, taken from a draft of the QUIC specification,
                  is given in <a href="#quic-reset-stream" class="auto internal xref">Figure 2</a>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-quics-reset_stream-frame-fo"></span><div id="quic-reset-stream">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.1-2.1">
<pre>:   The RESET_STREAM frame is as follows:
:
:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Stream ID (i)                        ...
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |  Application Error Code (16)  |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Final Size (i)                       ...
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:
:   RESET_STREAM frames contain the following fields:
:
:   Stream ID:  A variable-length integer encoding of the Stream ID
:      of the stream being terminated.
:
:   Application Protocol Error Code:  A 16-bit application protocol
:      error code (see Section 20.1) which indicates why the stream
:      is being closed.
:
:   Final Size: A variable-length integer indicating the final size
:      of the stream by the RESET_STREAM sender, in unit of bytes.
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-quics-reset_stream-frame-fo" class="selfRef">QUIC's RESET_STREAM frame format (from <em class="cite xref">[QUIC-TRANSPORT]</em>)</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">
                  These packet header diagrams, and the accompanying descriptions, are
                  formatted for human readers rather than for automated processing. As
                  a result, while there is rough consistency in how packet header diagrams are
                  formatted, there are a number of limitations that make them difficult
                  to work with programmatically:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">
                    Inconsistent syntax:
          </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">
                      There are two classes of consistency that are needed to support
                      automated processing of specifications: internal consistency
                      within a diagram or document, and external consistency across
                      all documents.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.2.2">
                        <a href="#quic-reset-stream" class="auto internal xref">Figure 2</a> gives an example of internal
                        inconsistency. Here, the packet diagram shows a field labelled
                        "Application Error Code", while the accompanying description lists
                        the field as "Application Protocol Error Code". The use of an
                        abbreviated name is suitable for human readers, but makes parsing
                        the structure difficult for machines.

                        <a href="#dhcpv6-relaysrcopt" class="auto internal xref">Figure 3</a> gives a further example, where
                        the description includes an "Option-Code" field that does not appear
                        in the packet diagram; and where the description states that
                        each field is 16 bits in length, but the diagram shows
                        the OPTION_RELAY_PORT as 13 bits, and Option-Len as 19 bits.

                        Another example is <span>[<a href="https://www.rfc-editor.org/info/rfc6958" class="cite xref">RFC6958</a>]</span>, where the packet
                        format diagram showing the structure of the Burst/Gap Loss Metrics
                        Report Block shows the Number of Bursts field as being 12 bits wide
                        but the corresponding text describes it as 16 bits.<a href="#section-2.1-4.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-4.2.3">
                        Comparing <a href="#quic-reset-stream" class="auto internal xref">Figure 2</a> with
                        <a href="#dhcpv6-relaysrcopt" class="auto internal xref">Figure 3</a> exposes external
                        inconsistency across documents. While the packet format
                        diagrams are broadly similar, the surrounding text is
                        formatted differently. If machine parsing is to be made
                        possible, then this text must be structured consistently.<a href="#section-2.1-4.2.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.3">
                      Ambiguous constraints:
          </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.4">
                      The constraints that are enforced on a particular field are often
                      described ambiguously, or in a way that cannot be parsed easily.
                      In <a href="#dhcpv6-relaysrcopt" class="auto internal xref">Figure 3</a>, each of the three fields
                      in the structure is constrained. The first two fields
                      ("Option-Code" and "Option-Len") are to be set to constant values
                      (note the inconsistency in how these constraints are expressed in
                      the description). However, the third field ("Downstream Source
                      Port") can take a value from a constrained set. This constraint
                      is expressed in prose that cannot readily by understood by machine.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.5">
                      Poor linking between sub-structures:
          </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.6">
            <p id="section-2.1-4.6.1">
                        Protocol data units and other structures are often comprised of
                        sub-structures that are defined elsewhere, either in the same
                        document or within a related document (e.g., a base protocol
                        specification document and a set of extensions). Chaining these structures
                        together is essential for machine parsing: the parsing process for
                        a protocol data unit is only fully expressed if all elements can
                        be parsed.<a href="#section-2.1-4.6.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.6.2">
                        <a href="#quic-reset-stream" class="auto internal xref">Figure 2</a> highlights the difficulty that
                        machine parsers have in chaining structures together. Two fields
                        ("Stream ID" and "Final Size") are described as being encoded as
                        variable-length integers; this is a structure described elsewhere
                        in the same document. Structured text is required both alongside
                        the definition of the containing structure and with the definition
                        of the sub-structure to allow a parser to link the two together.<a href="#section-2.1-4.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.7">
                        Lack of extension and evolution syntax:
          </dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.8">
            <p id="section-2.1-4.8.1">
                            Protocols are often specified across multiple documents, either
                            because the protocol explicitly includes extension points (e.g.,
                            profiles and payload format specifications in RTP
                            <span>[<a href="https://www.rfc-editor.org/info/rfc3550" class="cite xref">RFC3550</a>]</span>) or because definition of a protocol
                            data unit has changed and evolved over time. As a result, it is
                            essential that syntax be provided to allow for a complete
                            definition of a protocol's parsing process to be constructed
                            across multiple documents.<a href="#section-2.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-the-dhcpv6-relay-source-por"></span><div id="dhcpv6-relaysrcopt">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-2.1-5.1">
<pre>:   The format of the "Relay Source Port Option" is shown below:
:
:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |    OPTION_RELAY_PORT    |         Option-Len                  |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |    Downstream Source Port     |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:
:   Where:
:
:   Option-Code:  OPTION_RELAY_PORT. 16-bit value, 135.
:
:   Option-Len:  16-bit value to be set to 2.
:
:   Downstream Source Port:  16-bit value.  To be set by the IPv6
:      relay either to the downstream relay agent's UDP source port
:      used for the UDP packet, or to zero if only the local relay
:      agent uses the non-DHCP UDP port (not 547).
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-dhcpv6-relay-source-por" class="selfRef">The DHCPv6 Relay Source Port Option (from <em class="cite xref">[RFC8357]</em>)</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="background-others">
<section id="section-2.2">
        <h3 id="name-formal-languages-in-standar">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-formal-languages-in-standar" class="section-name selfRef">Formal languages in standards documents</a>
        </h3>
<p id="section-2.2-1">
                    A small proportion of IETF standards documents contain
                    structured and formal languages, including ABNF <span>[<a href="https://www.rfc-editor.org/info/rfc5234" class="cite xref">RFC5234</a>]</span>,
                    ASN.1 <span>[<a href="#ASN1" class="cite xref">ASN1</a>]</span>, C, CBOR <span>[<a href="https://www.rfc-editor.org/info/rfc7049" class="cite xref">RFC7049</a>]</span>, JSON,
                    the TLS presentation language <span>[<a href="https://www.rfc-editor.org/info/rfc8446" class="cite xref">RFC8446</a>]</span>, YANG models
                    <span>[<a href="https://www.rfc-editor.org/info/rfc7950" class="cite xref">RFC7950</a>]</span>, and XML. While this broad
                    range of languages may be problematic for the development of tooling
                    to parse specifications, these, and other, languages serve a range of
                    different use cases. ABNF, for example, is typically used to specify
                    text protocols, while ASN.1 is used to specify data structure
                    serialisation. This document specifies a structured language for specifying
                    the parsing of binary protocol data units.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="augmentedascii">
<section id="section-3">
      <h2 id="name-augmented-packet-header-dia">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-augmented-packet-header-dia" class="section-name selfRef">Augmented Packet Header Diagrams</a>
      </h2>
<p id="section-3-1">
                As discussed in <a href="#background-ascii" class="auto internal xref">Section 2.1</a> there are
                limitations to how packet header diagrams are used that must be addressed if they
                are to be parsed by machine. In this section, an augmented packet
                header diagram format is described. The principles that underpin the design of
                this format are discussed in <a href="#designprinciples" class="auto internal xref">Section 4</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
                The concept is illustrated by example, with accompanying
 explanatory descriptions.
                This is appropriate, given the visual nature of the 
language. A formal specification of the grammar for the augmented packet
 header diagrams is given in <a href="#ABNF" class="auto internal xref">Appendix A</a>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
              The augmented packet header diagram format described in 
this document aligns with an underlying protocol data model, the Network
 Packet Representation, outlined in <span>[<a href="http://dl.ifip.org/db/conf/networking/networking2021/1570702659.pdf" class="cite xref">NETWORKING2021</a>]</span>.
 Using a typed data model to express the syntax of protocols, and the 
way that they are parsed, allows for safety and complexity properties to
 be defined and enforced.  This underlying representation is independent
 of the description language used: the Augmented Packet Header Diagram 
format, defined in the sections that follow, is only one such approach.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
              Our examples are drawn from the specifications of TCP <span>[<a href="https://www.rfc-editor.org/info/rfc9293" class="cite xref">RFC9293</a>]</span>,
              STUN <span>[<a href="https://www.rfc-editor.org/info/rfc8489" class="cite xref">RFC8489</a>]</span>, and QUIC <span>[<a href="https://www.ietf.org/archive/id/draft-ietf-quic-transport-27.txt" class="cite xref">QUIC-TRANSPORT</a>]</span>. These examples
              are illustrative only of the Augmented Packet Header Diagram format that we define in
              this document, and they do not necessarily reflect the current state of the specifications
              they are taken from. For example, the published QUIC specification <span>[<a href="https://www.rfc-editor.org/info/rfc9000" class="cite xref">RFC9000</a>]</span> 
              does not use packet header diagrams to describe the syntax of the protocol.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="ascii-simple">
<section id="section-3.1">
        <h3 id="name-defining-protocol-data-unit">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-defining-protocol-data-unit" class="section-name selfRef">Defining Protocol Data Units</a>
        </h3>
<p id="section-3.1-1">
                  The Augmented Packet Header Diagram format introduces a new protocol
                  data unit description using the exact phrase "A _______ is formatted
                  as follows" within a paragraph (the phrasing "An ______ is formatted
                  as follows" can also be used). Optionally, this
                  phrase can include a note or comment, delimited by commas, immediately
                  following the PDU name. That is, "A/An _______, with an optional
                  comment, is formatted as follows" can be used to introduce a PDU
                  description.
                  This introductory phrase is followed by the PDU description itself, as a packet
                  diagram,
                  starting with a header line to show the bit width of the diagram.
                  The description of the fields follows the diagram, after a paragraph
                  that begins with the text "where:".<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
                  PDU names must be unique, both within a document, and across
                  all documents that are linked together using the
                  structured language defined in <a href="#ascii-import" class="auto internal xref">Section 3.9</a>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
                  Each field in the PDU is defined by a field in the packet header
                  diagram, a structured text definition, and a
                  prose description. The structured text definition comprises
                  the field name and an optional short name in parenthesis.
                  These are followed by a colon, the field length, an optional expression
                  constraining the value of the field, an optional presence constraint,
                  and, optionally, a terminating period.
                  The prose following the terminating period provides space for 
                  optional notes or comments.
                  Field names cannot be the same as a
                  previously defined PDU name, and must be unique within a given
                  structure definition. Prose descriptions may include
                  structured text (e.g., as defined in <a href="#ascii-store" class="auto internal xref">Section 3.6</a>).<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
                  A PDU may be defined not only by the layout and type of
                  its fields, but also by the values of those fields. For
                  example, field values may be constrained to some known value
                  or to be within a range. The "Data Offset" and
                  "Reserved" fields in the example below make use of value constraints.
                  More generally, the augmented packet header diagram
                  format enables a boolean expression to be attached to
                  a field, which must be true for the PDU to be parsed
                  successfully.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">
                  In addition, a PDU may contain fields that have a size that is specified in terms
                  of the value of another field. The constraint syntax can be
                  used to specify the length of fields in known units (of bits, bytes,
                  or other structures). In the example below, the "Options" field is defined in units of
                  "TCP Option" structures, and this is indicated by square brackets in the
                  diagram and description list.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">
                  If the units are of variable-width, then it may
                  not be possible to specify the length of the sequence. However, it is
                  still necessary to be able to constrain the overall width of the
                  field. To support this, the constraint syntax includes a "size"
                  function that evaluates to the width, in bits, of the given named
                  field. The "Options" field in the example below makes use of this
                  syntax to constrain the size of the field.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">
                  Finally, the presence of a field in a PDU may depend on the value of
                  other fields in that PDU. As shown by the "Options" field in the example
                  below, a constraint expression can be attached to each field, where that
                  field is only present in the PDU when the expression is true.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">
                 We define an ABNF grammar for constraint expressions in <a href="#ABNF-constraints" class="auto internal xref">Appendix A.1</a>.
                 This grammar is used across value, size, and presence constraint expressions.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">
                  The elements of an augmented packet header diagram 
                  can be illustrated using the TCP Header format
                 <span>[<a href="https://www.rfc-editor.org/info/rfc9293" class="cite xref">RFC9293</a>]</span>.  A TCP Header is formatted as follows:<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-10">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |       Destination Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Acknowledgment Number                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Data |       |C|E|U|A|P|R|S|F|                               |
| Offset| Rsrvd |W|C|R|C|S|S|Y|I|         Window Size           |
|       |       |R|E|G|K|H|T|N|N|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Checksum            |         Urgent Pointer        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          [Options]                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               :
:                            Payload                            :
:                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.1-10" class="pilcrow">¶</a>
</div>
<p id="section-3.1-11">
                  where:<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-12">
          <dt id="section-3.1-12.1">
                    Source Port: 16 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.2">
            <p id="section-3.1-12.2.1">
                      This is a fixed-width field, whose full label is shown in the diagram.
                      The field's width, 16 bits, is given in this description,
                      separated from the field's label by a colon.<a href="#section-3.1-12.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.3">
                     Destination Port: 2 bytes.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.4">
            <p id="section-3.1-12.4.1">
                       This is a fixed-width field as previously described. Where fields
                       are an integral number of bytes in size, the field length can be
                       given in bytes rather than in bits.<a href="#section-3.1-12.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.5">
                     Sequence Number: 32 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.6">
            <p id="section-3.1-12.6.1">
                       This is a fixed-width field as previously described.<a href="#section-3.1-12.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.7">
                     Acknowledgment Number: 32 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.8">
            <p id="section-3.1-12.8.1">
                       This is a fixed-width field as previously described.<a href="#section-3.1-12.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.9">
                     Data Offset (DOffset): 4 bits; DOffset &gt;= 5.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.10">
            <p id="section-3.1-12.10.1">
                       This is a fixed-width field, with a constraint on its value. At
                       most one field value constraint may be given per field, and if
                       provided, it must be given as a boolean expression, separated by a
                       semi-colon in the field definition name. If present, a
                       value constraint must follow the name, short name, and length of
                       the field, but appear before any presence constraint, if
                       applicable. The order of the field must be the same in both the
                       diagram and description list.<a href="#section-3.1-12.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.11">
                     Reserved (Rsrvd): 4 bits; Rsrvd == 0.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.12">
            <p id="section-3.1-12.12.1">
                       This is a fixed-width field, with a value constraint, as previously
                       described. This is a shorter field, whose full label is too large
                       to be shown in the diagram. A short label (Rsrvd) is used in the
                       diagram, and this short label is provided, in brackets, after the
                       full label in the description list.<a href="#section-3.1-12.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.13">
                    Control bits:
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.14">
            <p id="section-3.1-12.14.1">Optionally, field description lists can be nested. In this example, "Control bits" describes the group of 8 single
                bit fields that are described in the list that follows; it is these single bit fields that
                will form part of the structure.<a href="#section-3.1-12.14.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-12.14.2">
              <dt id="section-3.1-12.14.2.1">
                           CWR: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.2">
                <p id="section-3.1-12.14.2.2.1">
                               This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.3">
                           ECE: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.4">
                <p id="section-3.1-12.14.2.4.1">
                               This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.5">
                           URG: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.6">
                <p id="section-3.1-12.14.2.6.1">
                               This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.7">
                           ACK: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.8">
                <p id="section-3.1-12.14.2.8.1">
                               This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.8.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.9">
                           PSH: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.10">
                <p id="section-3.1-12.14.2.10.1">
                                This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.10.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.11">
                           RST: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.12">
                <p id="section-3.1-12.14.2.12.1">
                               This is a fixed-width field as previously described.<a href="#section-3.1-12.14.2.12.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.13">
                           SYN: 1 bit.
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.14">
                <p id="section-3.1-12.14.2.14.1">
                               This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.1-12.14.2.14.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-12.14.2.15">
                           FIN: 1 bit; (FIN == 0) || (SYN == 0).
              </dt>
              <dd style="margin-left: 1.5em" id="section-3.1-12.14.2.16">
                <p id="section-3.1-12.14.2.16.1">
                               This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.1-12.14.2.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.15">
                     Window Size: 16 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.16">
            <p id="section-3.1-12.16.1">
                       This is a fixed-width field as previously described.<a href="#section-3.1-12.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.17">
                     Checksum: 16 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.18">
            <p id="section-3.1-12.18.1">
                       This is a fixed-width field as previously described.<a href="#section-3.1-12.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.19">
                     Urgent Pointer: 16 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.20">
            <p id="section-3.1-12.20.1">
                        This is a fixed-width field as previously described.<a href="#section-3.1-12.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.21">
                     Options: [TCP Option]; size(Options) == (DOffset-5)*32; present only when DOffset &gt; 5.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.22">
            <p id="section-3.1-12.22.1">
                       This is a variable-width field that is comprised of a sequence
                       of TCP Option sub-structures. TCP Option is an enumerated type,
                       to be defined in <a href="#ascii-enums" class="auto internal xref">Section 3.3</a>. As defined, the
                       TCP Option type can be either 2 or 3 bytes, depending on the
                       option type. As a result, it is not possible to specify the
                       number of TCP Option structures that the Option field will
                       contain. However, the overall size of the field can be 
                       constrained. The "size(Options) == (DOffset-5)*32" makes use
                       of the "size" function. This evaluates to the size, in bits, of
                       the named field. The argument passed to the "size" field must
                       be the name of the field being defined, or of a previously
                       defined field.<a href="#section-3.1-12.22.1" class="pilcrow">¶</a></p>
<p id="section-3.1-12.22.2">
                       The "DOffset" field contains the number of 32-bit words that
                       are present in the TCP Header. By default, with no TCP options,
                       this is 5. As a result, the size of the Options field is
                       constrained to the value of DOffset, less 5, and multiplied to
                       get the value in bits.<a href="#section-3.1-12.22.2" class="pilcrow">¶</a></p>
<p id="section-3.1-12.22.3">
                       The presence of the "Options" field is predicated on an expression.
                       Optional fields are indicated by the presence of "; present only when [expr]."
                       at the end of the definition term.<a href="#section-3.1-12.22.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-12.23">
                     Payload.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.1-12.24">
                   This is a multi-row variable-length field, denoted in the packet header
                   diagram by the ":" notation in the
                    field's border. The length of the Payload is not specified, and hence needs to
                    be inferred from the total length of the packet and the lengths of the
                    known fields. There can only be one field of unspecified size in a PDU
                    Fields where the length is not specified may also denote this with the
                    phrase "variable length" in place of the length definition.<a href="#section-3.1-12.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-13">
                  The simplest PDU is one that contains only a set of fixed-width
                  fields in a known order, with no optional fields or variation
                  in the packet format.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">
                  Some packet formats include variable-width fields (e.g., the "Options" field
                  in the example above), where
                  the size of a field is either derived from the value of
                  some previous field, or is unspecified and inferred from
                  the total size of the packet and the size of the other
                  fields.<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">
                  To ensure that there is no ambiguity, a PDU description
                  can contain only one field whose length is unspecified.
                  The length of a single field, where all other fields are
                  of known (but perhaps variable) length, can be inferred
                  from the total size of the containing PDU. For example, the "Payload" field
                  in the example above is unspecified; its length can be determined by
                  subtracting the length of the other fields from the total size of the
                  PDU.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-xref">
<section id="section-3.2">
        <h3 id="name-cross-referencing-previousl">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cross-referencing-previousl" class="section-name selfRef">Cross-Referencing Previously Defined Fields</a>
        </h3>
<p id="section-3.2-1">
            Binary formats often reference sub-structures that have been
            defined earlier in the specification. For example, in TCP
            <span>[<a href="https://www.rfc-editor.org/info/rfc9293" class="cite xref">RFC9293</a>]</span>, the SACK Range Option (a TCP option type, as will be
            discussed in <a href="#ascii-enums" class="auto internal xref">Section 3.3</a>) is defined in terms of
            of SACK blocks. A SACK Block is formatted as follows:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Left Edge                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Right Edge                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">
              where:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-4">
          <dt id="section-3.2-4.1">
                  Left Edge: 4 bytes.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.2">
                  This is a fixed-width field, as described previously.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-4.3">
                  Right Edge: 4 bytes.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.4">
                  This is a fixed-width field, as described previously.<a href="#section-3.2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-5">
            The SACK Block sub-structure is then used in the definition of the
            SACK Range Option.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">
            A SACK Range Option is formatted as follows:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-7">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       5       |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            [Blocks]                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.2-7" class="pilcrow">¶</a>
</div>
<p id="section-3.2-8">
                where:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-9">
          <dt id="section-3.2-9.1">
                    Option Kind (Kind): 1 byte; Kind == 5.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.2-9.2">
                    This is a fixed-width field, as described previously.<a href="#section-3.2-9.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-9.3">
                    Option Length (Length): 1 byte.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.2-9.4">
                    This is a fixed-width field, as described previously.<a href="#section-3.2-9.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-9.5">
                    Blocks: (Length-2)/8 SACK Blocks.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.2-9.6">
            <p id="section-3.2-9.6.1">
                    Where a field is comprised of a sequence of previously defined structures,
                    square brackets can be used to indicate this in the diagram.  The length
                    of the sequence can be defined using the constraint expression
                    grammar as described earlier. Where the length is unknown, the type of each
                    element of the sequence must be given in square brackets.<a href="#section-3.2-9.6.1" class="pilcrow">¶</a></p>
<p id="section-3.2-9.6.2">
                    In this example, both a PDU name (SACK Block) and a field name (Length) are
                    used in the constraint expression. This is possible
                    because field names cannot be the same as previously defined PDU names.<a href="#section-3.2-9.6.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-enums">
<section id="section-3.3">
        <h3 id="name-specifying-enumerated-types">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-specifying-enumerated-types" class="section-name selfRef">Specifying Enumerated Types</a>
        </h3>
<p id="section-3.3-1">
              In addition to the use of the sub-structures, it is desirable to be able to define a type that
              may take the value of one of a set of alternative structures.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
              The alternative structures that comprise an enumerated 
type are identified using the exact phrase "The &lt;enumerated type 
name&gt;
               is one of: &lt;list of structure names&gt;" where the 
list of structure names is a comma
              separated list (with the last element, if there is more 
than one element, preceded by 'or'),
              each optionally preceded by "a" or "an". The structure 
names must be defined within the document or a linked document.
              Optionally, this phrase can include a note or comment, 
delimited by commas, immediately
              following the enumerated type name. That is, "The 
&lt;enumerated type name&gt;, with an
              optional comment, is one of: &lt;list of structure 
names&gt;" can be used to define an enumerated type. In both
              cases, the colon is optional; for example, "The 
&lt;enumerated type name&gt; is one of &lt;list of structure
              names&gt;" is valid.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">
                Where an enumerated type has only two variants, an 
alternative phrase can be used: "The &lt;enumerated type name&gt; is 
either a &lt;variant 1 name&gt; or &lt;variant 2 name&gt;". The names of
 the variants must be defined within the document or a linked document.
                An optional note or comment can be included with this 
alternative phrasing: "The &lt;enumerated type name&gt;, with an 
optional comment, is either a &lt;variant 1 name&gt; or &lt;variant 2 
name&gt;" can be used.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">
                  An EOL Option is formatted as follows:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-5">
<pre>0
0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+
|       0       |
+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3-6">
                     where:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-7">
          <dt id="section-3.3-7.1">
                         Option Kind (Kind): 1 byte; Kind == 0.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.3-7.2">
            <p id="section-3.3-7.2.1">
                            This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.3-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-8">
           A TCP Option is either an EOL Option or a SACK Range Option.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-split">
<section id="section-3.4">
        <h3 id="name-splitting-fields">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-splitting-fields" class="section-name selfRef">Splitting Fields</a>
        </h3>
<p id="section-3.4-1">
                          In some binary formats, fields are striped across multiple
                          non-contiguous bits. This is often to allow for backwards
                          compatibility with previous definitions of the same fields
                          in earlier documents: striping in this way allows for
                          careful use of the possible range of values.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
                          This format is illustrated using the STUN Message Type
                          <span>[<a href="https://www.rfc-editor.org/info/rfc8489" class="cite xref">RFC8489</a>]</span>.
                          A STUN Message Type is formatted as follows:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-3">
<pre> 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|C|M|M|M|C|M|M|M|M|
|B|A|9|8|7|1|6|5|4|0|3|2|1|0|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4-4">
                            where:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-5">
          <dt id="section-3.4-5.1">
                                Method (M): 12 bits (split field).
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.4-5.2">
                                This field is comprised of multiple sub-fields (M0 through
                                MB) as shown in the diagram. That these sub-fields should be
                                concatenated, after parsing, into a single field is indicated
                                by their being labelled using the 'M' short field name
                                followed by a single hexadecimal digit, with the least significant
                                bit labelled with 0, and subsequent bits labelled in sequence.<a href="#section-3.4-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-5.3">
                                Class (C): 2 bits (split field).
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.4-5.4">
                                This field follows the same format as M described above.<a href="#section-3.4-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-extendstructures">
<section id="section-3.5">
        <h3 id="name-extending-sub-structures">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-extending-sub-structures" class="section-name selfRef">Extending Sub-Structures</a>
        </h3>
<p id="section-3.5-1">
                A PDU may not only use or reference existing sub-structures, but they
                may extend them, adding new fields, or enforcing different or additional constraints.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">
               Where a sub-structure is extended, the diagram may show the sub-structure as
               a block, labelled with the sub-structure name. It may also be desirable to
               show the sub-structure diagram in full; in this case, the fields must be
               given in the same order and be of the same length. New field constraints
               can be shown. Similarly, in the description list, those fields inherited
               without change (i.e., with no change to their constraints) do not need to
               be repeated. Those with different or additional constraints must be described,
               and the order of the fields in the description list must match that of the
               sub-structure and the containing structure.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">
               This can be illustrated using QUIC <span>[<a href="https://www.ietf.org/archive/id/draft-ietf-quic-transport-27.txt" class="cite xref">QUIC-TRANSPORT</a>]</span>.
               A Long Header is formatted as follows:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-4">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+
|1|1| T | R | P |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Version                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    DCID Len   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Destination Connection ID (DCID)            ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    SCID Len   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Source Connection ID (SCID)                ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.5-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5-5">
                where:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-6">
          <dt id="section-3.5-6.1">
                  Header Form (HF): 1 bit; HF == 1.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.2">
                  This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.5-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.3">
                  Fixed Bit (FB): 1 bit; FB == 1.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.4">
                  This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.5-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.5">
                  Long Packet Type (T): 2 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.6">
                  This is a fixed-width field as previously described.<a href="#section-3.5-6.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.7">
                  Reserved Bits (R): 2 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.8">
                  This is a fixed-width field as previously described.<a href="#section-3.5-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.9">
                  Packet Number Length (P): 2 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.10">
                  This is a fixed-width field as previously described.<a href="#section-3.5-6.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.11">
                  Version ID (VID): 32 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.12">
                  This is a fixed-width field as previously described.<a href="#section-3.5-6.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.13">
                  DCID Len (DLen): 1 byte; DLen &lt;= 20.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.14">
                  This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.5-6.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.15">
                  Destination Connection ID (DCID): DLen bytes.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.16">
                  This is a fixed-width field, with a length constraint, as previously described.<a href="#section-3.5-6.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.17">
                  SCID Len (SLen): 1 byte; SLen &lt;= 20.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.18">
                  This is a fixed-width field, with a value constraint, as previously described.<a href="#section-3.5-6.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.19">
                  Source Connection ID (SCID): SLen bytes.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-6.20">
                  This is a variable-width field as previously described.<a href="#section-3.5-6.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-7">
               The syntax for extending sub-structures can be illustrated with the QUIC Retry Packet format
               <span>[<a href="https://www.ietf.org/archive/id/draft-ietf-quic-transport-27.txt" class="cite xref">QUIC-TRANSPORT</a>]</span>.
               A Retry Packet is formatted as follows:<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-8">
<pre>  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               :
 :                          Long Header                          :
 :                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Retry Token                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 +                                                               +
 |                                                               |
 +                     Retry Integrity Tag                       +
 |                                                               |
 +                                                               +
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.5-8" class="pilcrow">¶</a>
</div>
<p id="section-3.5-9">
                  where:<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-10">
          <dt id="section-3.5-10.1">
                    Long Header (LH): 1 Long Header; LH.T == 3.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-10.2">
                    This field is a previously defined sub-structure. 
Its constraints can access fields in that sub-structure. In this 
example, the T field of the Long Header must be equal to 3.<a href="#section-3.5-10.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-10.3">
                     Retry Token.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-10.4">
                    This is a variable-length field as previously defined.<a href="#section-3.5-10.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-10.5">
                    Retry Integrity Tag: 128 bits.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.5-10.6">
                    This is a fixed-width field as previously defined.<a href="#section-3.5-10.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-11">
                 As shown, the Long Header packet sub-structure is included. The Retry Packet enforces
                 a new value constraint on the Long Packet Type (T) field.<a href="#section-3.5-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-store">
<section id="section-3.6">
        <h3 id="name-storing-data-for-parsing">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-storing-data-for-parsing" class="section-name selfRef">Storing Data for Parsing</a>
        </h3>
<p id="section-3.6-1">
                  The parsing process may require data from previously parsed structures. This means that
                  data needs to be stored persistently throughout the process. This data needs to be
                  identified.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">
                  That the value of a particular field be stored upon 
parsing is indicated by the exact phrase "On receipt, the value of 
&lt;field name&gt; is stored as &lt;stored name&gt;." being present at 
the end of the description of a field.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">An Initial Packet is formatted as follows:<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-4">
<pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               :
  :                          Long Header                          :
  :                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.6-4" class="pilcrow">¶</a>
</div>
<p id="section-3.6-5">
                   where:<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.6-6">
          <dt id="section-3.6-6.1">
                      Long Header (LH): 1 Long Header; LH.T == 0.
          </dt>
          <dd style="margin-left: 1.5em" id="section-3.6-6.2">
                      This is field is a sub-structure, with a 
constraint, as previously defined. On receipt, the value of LH.DCID is 
stored as Initial DCID.<a href="#section-3.6-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.6-7">
                  In this example, the value of the DCID field of the Long Header sub-structure is stored as Initial DCID.<a href="#section-3.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-functions">
<section id="section-3.7">
        <h3 id="name-connecting-structures-with-">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-connecting-structures-with-" class="section-name selfRef">Connecting Structures with Functions</a>
        </h3>
<p id="section-3.7-1">
                The parsing or serialisation of some binary formats cannot be fully described without
                the use of functions. These functions take arguments (values from another structure),
                perform some computation, and generate a new structure.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">
                Given the goal of fully capturing the parsing or serialisation of binary protocols, it
                is necessary to include the signature of these helper functions.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">
                Function signatures are constructed by
                the word "func", followed by a space, then the name of the function. This is immediately
                followed by a set of brackets containing a comma separated list of the function's parameters,
                formatted as "&lt;parameter name&gt;: &lt;parameter type&gt;". This is followed by "-&gt;"
                and the return type of the function, followed by a colon.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4">
                The body of the function is not captured, owing to the complexity of both capturing and translating
                arbitrary code. As a result, it can be described in whichever format is most suitable for the
                document and its readership.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5">
                  Those values that are stored persistently, as defined in <a href="#ascii-store" class="auto internal xref">Section 3.6</a>, are accessible by functions.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">
                As an example, the "apply_protection" function is defined as:<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-7">
<pre>func apply_protection(to: Unprotected Packet)
                -&gt; Protected Packet:
   apply packet protection to payload
   apply header protection to first_byte and packet_number
   construct appropriate Protected Packet based on first_byte
   return Protected Packet
</pre><a href="#section-3.7-7" class="pilcrow">¶</a>
</div>
<p id="section-3.7-8">
              In this example, 'Unprotected Packet' and 'Protected Packet' are existing types.
              The text in the function body is not interpreted.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
<p id="section-3.7-9">
              A common use of functions is to specify operations used during
              packet parsing and serialisation.<a href="#section-3.7-9" class="pilcrow">¶</a></p>
<p id="section-3.7-10">
                To indicate that a PDU is created from another by way of a
                function, the sentence "A/An &lt;PDU name A&gt; is parsed from a
                &lt;PDU name B&gt; using the &lt;function name&gt; function" is used.
                This indicates that a PDU A is generated by passing PDU B into
                the named function. The function must take a single parameter,
                of the same type as PDU B, and return a PDU B.<a href="#section-3.7-10" class="pilcrow">¶</a></p>
<p id="section-3.7-11">
                To indicate that a PDU can be serialised to another by way of a
                function, the sentence "A/An &lt;PDU name A&gt; is serialised to a
                &lt;PDU name B&gt; using the &lt;function name&gt; function" is used.
                This indicates that a PDU B is generated by passing PDU A into
                the named function. The function must take a single parameter,
                of the same type as PDU A, and return a PDU B.<a href="#section-3.7-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-pdus">
<section id="section-3.8">
        <h3 id="name-specifying-protocols">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-specifying-protocols" class="section-name selfRef">Specifying Protocols</a>
        </h3>
<p id="section-3.8-1">
                  A document will set out different structures that are not, on their own, protocol data units.
                  To capture the parsing or serialisation of a protocol, it is necessary to be able to identify
                  or construct those packets that are valid PDUs. As a result, it is necessary for the document
                  to identify those structures that are PDUs.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">
                  The PDUs that comprise a protocol are identified using the
                  exact phrase "This document describes the &lt;protocol name&gt;
                  protocol. The &lt;protocol name&gt; protocol uses &lt;list of PDU
                  names&gt;" where the list of PDU names is a comma separated list
                  (with the last element, if there is more than one element,
                  preceded by 'and'), each optionally preceded by "a" or "an".
                  As a short-form, the variation "This document
                  describes the &lt;protocol name&gt;, which uses &lt;list of PDU
                  names&gt;" can be used as an alternative. The PDU names must be structure
                  names defined in the document
                  or a linked document. The PDU names are pluralised in the
                  list. A document must contain exactly one instance of this
                  phrase.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">
                  This document describes the Example protocol. The 
Example protocol uses Long Headers, STUN Message Types, and TCP Headers.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-import">
<section id="section-3.9">
        <h3 id="name-importing-definitions-from-">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-importing-definitions-from-" class="section-name selfRef">Importing Definitions from Other Documents</a>
        </h3>
<p id="section-3.9-1">
                  Protocols are often specified across multiple documents, either because
                  the specification of a protocol's data units has changed over time, or
                  because of explicit extension points contained in the protocol's original
                  specification. To allow a document to make use of a previous PDU definition,
                  it is possible to import PDU definitions (written in the format described in
                  this document) from other documents.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">
                  A PDU definition is imported using the exact phrase "A/An ________ is formatted as
                  described in &lt;document identifier&gt;". The document identifier must refer, unambiguously,
                  to an existing document. An Internet-Draft is identified by its name. RFCs are identified by
                  "RFC" followed by their number.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="designprinciples">
<section id="section-4">
      <h2 id="name-design-principles">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-design-principles" class="section-name selfRef">Design Principles</a>
      </h2>
<p id="section-4-1">
                The use of structures that are designed to support machine readability
                might potentially interfere with the existing ways in which protocol
                specifications are used and authored. To the extent that these existing uses
                are more important than machine readability, such interference must be
                minimised.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
                In this section, the broad design principles that underpin the format
                described by this document are given. However, these principles apply more
                generally to any approach that introduces structured and formal languages
                into standards documents.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
                It should be noted that these are design principles: they expose the
                trade-offs that are inherent within any given approach. Violating these
                principles is sometimes necessary and beneficial, and this document sets
                out the potential consequences of doing so.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
                The central tenet that underpins these design principles is a recognition
                that the IETF standardisation process is not broken, and so does not need to be
                fixed. Failure to recognise this will likely lead to approaches that are
                incompatible with the standards process, or that will see limited
                adoption. However, the standards process can be improved with appropriate
                approaches, as guided by the following broad design principles:<a href="#section-4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-5">
        <dt id="section-4-5.1">
                    Most readers are human:
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-5.2">
          <p id="section-4-5.2.1">
                        Primarily, standards documents should be written for people, who
                        require text and diagrams that they can understand. Structures that
                        cannot be easily parsed by people should be avoided, and if
                        included, should be clearly delineated from human-readable
                        content.<a href="#section-4-5.2.1" class="pilcrow">¶</a></p>
<p id="section-4-5.2.2">
                        Any approach that shifts this balance -- that is, that primarily
                        targets machine readers -- is likely to be disruptive to the
                        standardisation process, which relies upon discussion centered
                        around documents written in prose.<a href="#section-4-5.2.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.3">
                    Writing tools are diverse:
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-5.4">
          <p id="section-4-5.4.1">
                        Standards document writing is a distributed process that involves a diverse set of
                        tools and workflows. The introduction of machine-readable
                        structures into specifications should not require that specific tools are
                        used to produce standards documents, to ensure that disruption to
                        existing workflows is minimised. This does not preclude the
                        development of optional, supplementary tools that aid in the
                        authoring machine-readable structures.<a href="#section-4-5.4.1" class="pilcrow">¶</a></p>
<p id="section-4-5.4.2">
                        The immediate impact of requiring specific tooling is that
                        adoption is likely to be limited. A long-term impact might be that
                        authors whose workflows are incompatible might be alienated from
                        the process.<a href="#section-4-5.4.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.5">
                    Canonical specifications:
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-5.6">
          <p id="section-4-5.6.1">
                        As far as possible, machine-readable structures should not
                        replicate the human readable specification of the protocol
                        within the same document. Machine-readable structures should form part
                        of a canonical specification of the protocol. Adding supplementary
                        machine-readable structures, in parallel to the existing
                        human readable text, is undesirable because it creates
                        the potential for inconsistency.<a href="#section-4-5.6.1" class="pilcrow">¶</a></p>
<p id="section-4-5.6.2">
                        As an example, program code that describes how a protocol data
                        unit can be parsed might be provided as an appendix within a
                        standards document. This code would provide a specification of
                        the protocol that is separate to the prose description in the
                        main body of the document. This has the undesirable effect of
                        introducing the potential for the program code to specify behaviour
                        that the prose-based specification does not, and vice-versa.<a href="#section-4-5.6.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.7">
                    Expressiveness:
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-5.8">
          <p id="section-4-5.8.1">
                        Any approach should be expressive enough to capture the syntax
                        and parsing process for the majority of binary protocols. If a
                        given language is not sufficiently expressive, then adoption is
                        likely to be limited. At the limits of what can be expressed by
                        the language, authors are likely to revert to defining the
                        protocol in prose: this undermines the broad goal of using
                        structured and formal languages. Equally, though, understandable
                        specifications and ease of use are critical for adoption. A
                        tool that is simple to use and addresses the most common use
                        cases might be preferred to a complex tool that addresses all
                        use cases.<a href="#section-4-5.8.1" class="pilcrow">¶</a></p>
<p id="section-4-5.8.2">
                        It may be desirable to restrict expressiveness, however, to
                        guarantee intrinsic safety, security, and computability
                        properties of both the generated parser code for the protocol,
                        and the parser of the description language itself. In
                        much the same way as the language-theoretic security
                        (<span>[<a href="http://langsec.org/" class="cite xref">LANGSEC</a>]</span>) community advocates for programming
                        language design to be informed by the desired properties of
                        the parsers for those languages, protocol designers should be
                        aware of the implications of their design choices. The
                        expressiveness of the protocol description languages that they use to
                        define their protocols can force such awareness.<a href="#section-4-5.8.2" class="pilcrow">¶</a></p>
<p id="section-4-5.8.3">
                        Broadly, those languages that have grammars which are more expressive tend to
                        have parsers that are more complex and less safe. As a
                        result, while considering the other goals described in
                        this document, protocol description languages should attempt to be
                        minimally expressive, and either restrict protocol designs to
                        those for which safe and secure parsers can be generated, or
                        as a minimum, ensure that protocol designers are aware of the boundaries their
                        designs cross, in terms of computability and decidability <span>[<a href="https://www.usenix.org/publications/login/december-2011-volume-36-number-6/halting-problems-network-stack-insecurity" class="cite xref">SASSAMAN</a>]</span>.<a href="#section-4-5.8.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.9">
                    Minimise required change:
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-5.10">
          <p id="section-4-5.10.1">
                        Any approach should require as few changes as possible to the way
                        that documents are formatted, authored, and published. Forcing adoption
                        of a particular structured or formal language is incompatible with
                        the IETF's standardisation process: there are very few components
                        of standards documents that are non-optional.<a href="#section-4-5.10.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">
                This document contains no actions for IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
                Poorly implemented parsers are a frequent source of security
                vulnerabilities in protocol implementations. Structuring the
                description of a protocol data unit so that a parser can be
                automatically derived from the specification can reduce the
                likelihood of vulnerable implementations.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
                As described in <a href="#designprinciples" class="auto internal xref">Section 4</a>, the expressiveness
                of a protocol description language has implications for the safety,
                security, and computability properties of the parser for the protocol
                description language itself, and on the generated parser code for the
                protocols described using it. The language-theoretic security (<span>[<a href="http://langsec.org/" class="cite xref">LANGSEC</a>]</span>)
                community explores the security implications of programming language
                design; the principles developed in that community should guide the
                development of protocol description languages.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-7">
      <h2 id="name-acknowledgements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-7-1">
              The authors would like to thank Marc Petit-Huguenin for
              extensive feedback on the draft, including work on formalising
              the constraint syntax as given in <a href="#ABNF-constraints" class="auto internal xref">Appendix A.1</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
              Wesley Eddy provided valuable feedback on the description format through
              adopting it in <span>[<a href="https://www.rfc-editor.org/info/rfc9293" class="cite xref">RFC9293</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
                The authors would like to thank David Southgate for preparing
                a prototype implementation of some of the ideas described here.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">
                This work has received funding from the UK Engineering and Physical
                Sciences Research Council under grant EP/R04144X/1.<a href="#section-7-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-informative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC8357">[RFC8357]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Generalized UDP Source Port for DHCP Relay"</span>, <span class="seriesInfo">RFC 8357</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8357">https://www.rfc-editor.org/info/rfc8357</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TRANSPORT">[QUIC-TRANSPORT]</dt>
      <dd>
<span class="refAuthor">Iyengar, J.</span> and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-27</span>, <time datetime="2020-02-21" class="refDate">21 February 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-quic-transport-27.txt">https://www.ietf.org/archive/id/draft-ietf-quic-transport-27.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
      <dd>
<span class="refAuthor">Iyengar, J.</span> and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6958">[RFC6958]</dt>
      <dd>
<span class="refAuthor">Clark, A.</span>, <span class="refAuthor">Zhang, S.</span>, <span class="refAuthor">Zhao, J.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"RTP Control Protocol (RTCP) Extended Report (XR) Block for Burst/Gap Loss Metric Reporting"</span>, <span class="seriesInfo">RFC 6958</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6958">https://www.rfc-editor.org/info/rfc6958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
      <dd>
<span class="refAuthor">Bjorklund, M.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
      <dd>
<span class="refAuthor">Crocker, D.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">RFC 5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASN1">[ASN1]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"ITU-T Recommendation X.680, X.681, X.682, and X.683"</span>, <span class="seriesInfo">ITU-T Recommendation X.680, X.681, X.682, and X.683</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3550">[RFC3550]</dt>
      <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Casner, S.</span>, <span class="refAuthor">Frederick, R.</span>, and <span class="refAuthor">V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">RFC 3550</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8489">[RFC8489]</dt>
      <dd>
<span class="refAuthor">Petit-Huguenin, M.</span>, <span class="refAuthor">Salgueiro, G.</span>, <span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Mahy, R.</span>, and <span class="refAuthor">P. Matthews</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 8489</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8489">https://www.rfc-editor.org/info/rfc8489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC793">[RFC793]</dt>
      <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">RFC 793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LANGSEC">[LANGSEC]</dt>
      <dd>
<span class="refAuthor">LANGSEC</span>, <span class="refTitle">"LANGSEC: Language-theoretic Security"</span>, <span>&lt;<a href="http://langsec.org/">http://langsec.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SASSAMAN">[SASSAMAN]</dt>
      <dd>
<span class="refAuthor">Sassaman, L.</span>, <span class="refAuthor">Patterson, M. L.</span>, <span class="refAuthor">Bratus, S.</span>, and <span class="refAuthor">A. Shubina</span>, <span class="refTitle">"The Halting Problems of Network Stack Insecurity"</span>, <span class="refContent">;login: -- December 2011, Volume 36, Number 6</span>, <span>&lt;<a href="https://www.usenix.org/publications/login/december-2011-volume-36-number-6/halting-problems-network-stack-insecurity">https://www.usenix.org/publications/login/december-2011-volume-36-number-6/halting-problems-network-stack-insecurity</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9293">[RFC9293]</dt>
      <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">RFC 9293</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9293">https://www.rfc-editor.org/info/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NETWORKING2021">[NETWORKING2021]</dt>
    <dd>
<span class="refAuthor">McQuistin, S.</span>, <span class="refAuthor">Band, V.</span>, <span class="refAuthor">Jacob, D.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Investigating Automatic Code Generation for Network Packet Parsing"</span>, <span class="refContent">Proceedings of the 20th International IFIP TC6 Networking Conference, Networking 2021, Espoo, Finland, June 21-24, 2021</span>, <span>&lt;<a href="http://dl.ifip.org/db/conf/networking/networking2021/1570702659.pdf">http://dl.ifip.org/db/conf/networking/networking2021/1570702659.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="ABNF">
<section id="appendix-A">
      <h2 id="name-abnf-specification">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-abnf-specification" class="section-name selfRef">ABNF specification</a>
      </h2>
<div id="ABNF-constraints">
<section id="appendix-A.1">
        <h3 id="name-constraint-expressions">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-constraint-expressions" class="section-name selfRef">Constraint Expressions</a>
        </h3>
<div class="lang-abnf sourcecode" id="appendix-A.1-1">
<pre>constant = %x31-39 *(%x30-39)  ; natural numbers without leading 0s
short-name = ALPHA *(ALPHA / DIGIT / "-" / "_")
name = short-name *(" " short-name)
sp = [" "] ; optional space in expression
bool-expr = "(" sp bool-expr sp ")" /
           "!" sp bool-expr /
           bool-expr sp bool-op sp bool-expr /
           bool-expr sp "?" sp expr sp ":" sp expr /
           expr sp cmp-op sp expr
bool-op = "&amp;&amp;" / "||"
cmp-op = "==" / "!=" / "&lt;" / "&lt;=" / "&gt;" / "&gt;="
expr = "(" sp expr sp ")" /
      expr sp op sp expr /
      bool-expr "?" expr ":" expr /
      name / short-name "." short-name /
      "size(" short-name ")" /
      constant
op = "+" / "-" / "*" / "/" / "%" / "^"
length = expr sp unit / "[" sp name sp "]" / "variable length"
unit = %s"bit" / %s"bits" / %s"byte" / %s"bytes" / name
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ABNF-diagrams">
<section id="appendix-A.2">
        <h3 id="name-augmented-packet-diagrams">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-augmented-packet-diagrams" class="section-name selfRef">Augmented packet diagrams</a>
        </h3>
<p id="appendix-A.2-1">
                    Future revisions of this draft will include an ABNF specification for
                    the augmented packet diagram format described in
                    <a href="#augmentedascii" class="auto internal xref">Section 3</a>. Such a specification is omitted from
                    this draft given that the format is likely to change as its syntax is
                    developed. Given the visual nature of the format, it is more
                    appropriate for discussion to focus on the examples given in
                    <a href="#augmentedascii" class="auto internal xref">Section 3</a>.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="source">
<section id="appendix-B">
      <h2 id="name-tooling-source-code">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-tooling-source-code" class="section-name selfRef">Tooling &amp; source code</a>
      </h2>
<p id="appendix-B-1">
                The source for this draft is available from
                <span><a href="https://github.com/glasgow-ipl/draft-mcquistin-augmented-ascii-diagrams">https://github.com/glasgow-ipl/draft-mcquistin-augmented-ascii-diagrams</a></span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
                The source code for tooling that can be used to parse this document is available
                from <span><a href="https://github.com/glasgow-ipl/ips-protodesc-code">https://github.com/glasgow-ipl/ips-protodesc-code</a></span>. This tooling
                supports the automatic generation of Rust parser code from protocol descriptions written
                in the Augmented Packet Header Diagram format. It also provides test harnesses that
                demonstrate that the description of TCP <span>[<a href="https://www.rfc-editor.org/info/rfc9293" class="cite xref">RFC9293</a>]</span> written in this format can
                be used to generate parser code.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stephen McQuistin</span></div>
<div dir="auto" class="left"><span class="org">University of St Andrews</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computer Science</span></div>
<div dir="auto" class="left"><span class="locality">St Andrews</span></div>
<div dir="auto" class="left"><span class="postal-code">KY16 9AJ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sm@smcquistin.uk" class="email">sm@smcquistin.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vivian Band</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vivianband0@gmail.com" class="email">vivianband0@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dejice Jacob</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dejice.jacob@glasgow.ac.uk" class="email">dejice.jacob@glasgow.ac.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Colin Perkins</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:csp@csperkins.org" class="email">csp@csperkins.org</a>
</div>
</address>
</section>
</div>
</div>

                    </div>
                
            </div>
            <div class="d-print-none col-md-3 bg-light-subtle collapse show" id="sidebar">
                <div class="position-fixed border-start sidebar overflow-scroll overscroll-none no-scrollbar">
                    <div class="pt-2 pt-lg-3 px-md-2 px-lg-3">
                        <a class="btn btn-primary btn-sm" href="https://datatracker.ietf.org/doc/draft-mcquistin-augmented-ascii-diagrams/">Datatracker</a>
                        <p class="fw-bold pt-2">
                                
                                    draft-mcquistin-augmented-ascii-diagrams-13
                                
                                <br>
                                <span class="badge rounded-pill badge-draft">
                                    
                                        Internet-Draft
                                    
                                </span>

                        </p>
                        
                        <ul class="nav nav-tabs nav-fill small" role="tablist">
                            <li class="nav-item" role="presentation" data-bs-original-title="Document information">
                                <button class="nav-link px-2 active" id="docinfo-tab" data-bs-toggle="tab" data-bs-target="#docinfo-tab-pane" type="button" role="tab" aria-controls="docinfo-tab-pane" aria-selected="true">
                                    <i class="bi bi-info-circle"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Info</span>
                                </button>
                            </li>
                            <li class="nav-item" role="presentation" data-bs-original-title="Table of contents" aria-describedby="tooltip285844">
                                <button class="nav-link px-2" id="toc-tab" data-bs-toggle="tab" data-bs-target="#toc-tab-pane" type="button" role="tab" aria-controls="toc-tab-pane" aria-selected="false" tabindex="-1">
                                    <i class="bi bi-list-ol"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Contents</span>
                                </button>
                            </li>
                            <li class="nav-item" role="presentation" data-bs-original-title="Preferences">
                                <button class="nav-link px-2" id="pref-tab" data-bs-toggle="tab" data-bs-target="#pref-tab-pane" type="button" role="tab" aria-controls="pref-tab-pane" aria-selected="false" tabindex="-1">
                                    <i class="bi bi-gear"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Prefs</span>
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content pt-2">
                            <div class="tab-pane active show" id="docinfo-tab-pane" role="tabpanel" aria-labelledby="docinfo-tab" tabindex="0">
                                <table class="table table-sm table-borderless">
                                    






<tbody class="meta align-top ">
    <tr>
        <th scope="row">Document</th>
        <th scope="row">Document type</th>
        <td class="edit"></td>
        <td>
            
                
                    <span class="text-success">Active Internet-Draft</span>
                    (individual)
                    
                
            
            
        </td>
    </tr>
    
        <tr>
            <td></td>
            <th scope="row">Select version</th>
            <td class="edit"></td>
            <td>
                



    <ul class="revision-list pagination pagination-sm text-center flex-wrap my-0">
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-00">
                        00
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-01" rel="nofollow">
                        01
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-02" rel="nofollow">
                        02
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-03" rel="nofollow">
                        03
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-04" rel="nofollow">
                        04
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-05" rel="nofollow">
                        05
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-06" rel="nofollow">
                        06
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-07" rel="nofollow">
                        07
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-08" rel="nofollow">
                        08
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-09" rel="nofollow">
                        09
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-10" rel="nofollow">
                        10
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-11" rel="nofollow">
                        11
                    </a>
                </li>
            
        
            
                <li class="page-item ">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-12" rel="nofollow">
                        12
                    </a>
                </li>
            
        
            
                <li class="page-item active">
                    <a class="page-link" href="https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-13">
                        13
                    </a>
                </li>
            
        
        
    </ul>

            </td>
        </tr>
        
            <tr>
                <td></td>
                <th scope="row">Compare versions</th>
                <td class="edit"></td>
                <td>
                    



<form class="form-horizontal diff-form" action="https://author-tools.ietf.org/iddiff" method="get" target="_blank">


            <select class="form-select form-select-sm mb-1 select2-field select2-hidden-accessible" data-max-entries="1" data-width="resolve" data-allow-clear="false" data-minimum-input-length="0" aria-label="From revision" name="url1" data-select2-id="select2-data-7-ugzt" tabindex="-1" aria-hidden="true">
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-13">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-12" selected="selected" data-select2-id="select2-data-9-5qd7">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-11">
                        draft-mcquistin-augmented-ascii-diagrams-11
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-10">
                        draft-mcquistin-augmented-ascii-diagrams-10
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-09">
                        draft-mcquistin-augmented-ascii-diagrams-09
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-08">
                        draft-mcquistin-augmented-ascii-diagrams-08
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-07">
                        draft-mcquistin-augmented-ascii-diagrams-07
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-06">
                        draft-mcquistin-augmented-ascii-diagrams-06
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-05">
                        draft-mcquistin-augmented-ascii-diagrams-05
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-04">
                        draft-mcquistin-augmented-ascii-diagrams-04
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-03">
                        draft-mcquistin-augmented-ascii-diagrams-03
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-02">
                        draft-mcquistin-augmented-ascii-diagrams-02
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-01">
                        draft-mcquistin-augmented-ascii-diagrams-01
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-00">
                        draft-mcquistin-augmented-ascii-diagrams-00
                        
                    </option>
                
                
            </select><span class="select2 select2-container select2-container--bootstrap-5" dir="ltr" data-select2-id="select2-data-8-ycue" style="width: 228.75px;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-sm mb-1" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-url1-rr-container" aria-controls="select2-url1-rr-container"><span class="select2-selection__rendered" id="select2-url1-rr-container" role="textbox" aria-readonly="true" title="
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    ">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>

            <select class="form-select form-select-sm mb-1 select2-field select2-hidden-accessible" data-max-entries="1" data-width="resolve" data-allow-clear="false" data-minimum-input-length="0" aria-label="To revision" name="url2" data-select2-id="select2-data-10-bemn" tabindex="-1" aria-hidden="true">
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-13" selected="selected" data-select2-id="select2-data-12-b9ql">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-12">
                        draft-mcquistin-augmented-ascii-diagrams-12
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-11">
                        draft-mcquistin-augmented-ascii-diagrams-11
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-10">
                        draft-mcquistin-augmented-ascii-diagrams-10
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-09">
                        draft-mcquistin-augmented-ascii-diagrams-09
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-08">
                        draft-mcquistin-augmented-ascii-diagrams-08
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-07">
                        draft-mcquistin-augmented-ascii-diagrams-07
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-06">
                        draft-mcquistin-augmented-ascii-diagrams-06
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-05">
                        draft-mcquistin-augmented-ascii-diagrams-05
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-04">
                        draft-mcquistin-augmented-ascii-diagrams-04
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-03">
                        draft-mcquistin-augmented-ascii-diagrams-03
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-02">
                        draft-mcquistin-augmented-ascii-diagrams-02
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-01">
                        draft-mcquistin-augmented-ascii-diagrams-01
                        
                    </option>
                
                    <option value="draft-mcquistin-augmented-ascii-diagrams-00">
                        draft-mcquistin-augmented-ascii-diagrams-00
                        
                    </option>
                
                
            </select><span class="select2 select2-container select2-container--bootstrap-5" dir="ltr" data-select2-id="select2-data-11-u5as" style="width: 228.75px;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-sm mb-1" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-url2-cj-container" aria-controls="select2-url2-cj-container"><span class="select2-selection__rendered" id="select2-url2-cj-container" role="textbox" aria-readonly="true" title="
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    ">
                        draft-mcquistin-augmented-ascii-diagrams-13
                        
                    </span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>

            <button type="submit" class="btn btn-primary btn-sm" value="--html" name="difftype">
                Side-by-side
            </button>
            
            <button type="submit" class="btn btn-primary btn-sm" value="--hwdiff" name="difftype">
                Inline
            </button>


</form>
                </td>
            </tr>
        
    
    <tr>
        <td></td>
        <th scope="row">Authors</th>
        <td class="edit">
            
        </td>
        <td>
            
            
                <span><a href="https://datatracker.ietf.org/person/sm@smcquistin.uk" data-bs-original-title="Datatracker profile of Stephen McQuistin.">Stephen McQuistin</a> <a href="mailto:sm%40smcquistin.uk" aria-label="Compose email to sm@smcquistin.uk." data-bs-original-title="Compose email to sm@smcquistin.uk.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/vivianband0@gmail.com" data-bs-original-title="Datatracker profile of Vivian Band.">Vivian Band</a> <a href="mailto:vivianband0%40gmail.com" aria-label="Compose email to vivianband0@gmail.com." data-bs-original-title="Compose email to vivianband0@gmail.com.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/dejice.jacob@glasgow.ac.uk" data-bs-original-title="Datatracker profile of Dejice Jacob.">Dejice Jacob</a> <a href="mailto:dejice.jacob%40glasgow.ac.uk" aria-label="Compose email to dejice.jacob@glasgow.ac.uk." data-bs-original-title="Compose email to dejice.jacob@glasgow.ac.uk.">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span><a href="https://datatracker.ietf.org/person/csp@csperkins.org" data-bs-original-title="Datatracker profile of Colin Perkins.">Colin Perkins</a> <a href="mailto:csp%40csperkins.org" aria-label="Compose email to csp@csperkins.org." data-bs-original-title="Compose email to csp@csperkins.org.">
                <i class="bi bi-envelope"></i></a></span>
            
            
                <br>
                <a class="btn btn-primary btn-sm mt-1" href="mailto:draft-mcquistin-augmented-ascii-diagrams@ietf.org?subject=draft-mcquistin-augmented-ascii-diagrams" data-bs-original-title="Send email to the document authors">Email authors</a>
            
        </td>
    </tr>
    
    
    
    
    <tr>
        <td></td>
        <th scope="row">
            RFC stream
        </th>
        <td class="edit">
            
        </td>
        <td>
            
                
                    <a href="https://datatracker.ietf.org/stream/ise/">
                
                
                    
                        Independent Submission
                    
                
                
                    </a>
                
            
        </td>
    </tr>
    
    <tr>
        <td></td>
        <th scope="row">
            Other formats
        </th>
        <td class="edit">
        </td>
        <td>
            
                
    <div class="buttonlist">
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.txt">
            
                <i class="bi bi-file-text"></i> txt
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.html">
            
                <i class="bi bi-file-code"></i> html
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://www.ietf.org/archive/id/draft-mcquistin-augmented-ascii-diagrams-13.xml">
            
                <i class="bi bi-file-code"></i> xml
            
        </a>
        
    
        
    
        
        <a class="btn btn-primary btn-sm" download="draft-mcquistin-augmented-ascii-diagrams-13.pdf" target="_blank" href="https://datatracker.ietf.org/doc/pdf/draft-mcquistin-augmented-ascii-diagrams-13">
            
                <i class="bi bi-file-pdf"></i> pdf
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://datatracker.ietf.org/doc/draft-mcquistin-augmented-ascii-diagrams/13/bibtex/">
            
                <i class="bi bi-file-ruled"></i> bibtex
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm" target="_blank" href="https://datatracker.ietf.org/doc/bibxml3/draft-mcquistin-augmented-ascii-diagrams-13.xml">
            
                <i class="bi bi-file-code"></i> bibxml
            
        </a>
        
    
</div>

            
        </td>
    </tr>
    
    
        
    
</tbody>
                                </table>
                                <a class="btn btn-sm btn-warning mb-3" target="_blank" href="https://github.com/ietf-tools/datatracker/issues/new/choose">
                                    Report a datatracker bug
                                    <i class="bi bi-bug"></i>
                                </a>
                            </div>
                            <div class="tab-pane mb-5" id="toc-tab-pane" role="tabpanel" aria-labelledby="toc-tab" tabindex="0">
                                <nav class="nav nav-pills flex-column small" id="toc-nav">
                                <a class="nav-link ps-1 d-flex hyphenate py-0" href="#abstract"><div class="text-break">Abstract</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-status-of-this-memo"><div class="text-break">Status of This Memo</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-copyright-notice"><div class="text-break">Copyright Notice</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-table-of-contents"><div class="text-break">Table of Contents</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-introduction"><div class="pe-1">1.</div><div class="text-break">Introduction</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-background"><div class="pe-1">2.</div><div class="text-break">Background</div></a><nav class="nav-pills ps-3 flex-column"><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-limitations-of-current-pack"><div class="pe-1">2.1.</div><div class="text-break">Limitations of Current Packet Header Diagrams</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-formal-languages-in-standar"><div class="pe-1">2.2.</div><div class="text-break">Formal languages in standards documents</div></a></nav><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-augmented-packet-header-dia"><div class="pe-1">3.</div><div class="text-break">Augmented Packet Header Diagrams</div></a><nav class="nav-pills ps-3 flex-column"><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-defining-protocol-data-unit"><div class="pe-1">3.1.</div><div class="text-break">Defining Protocol Data Units</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-cross-referencing-previousl"><div class="pe-1">3.2.</div><div class="text-break">Cross-Referencing Previously Defined Fields</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-specifying-enumerated-types"><div class="pe-1">3.3.</div><div class="text-break">Specifying Enumerated Types</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-splitting-fields"><div class="pe-1">3.4.</div><div class="text-break">Splitting Fields</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-extending-sub-structures"><div class="pe-1">3.5.</div><div class="text-break">Extending Sub-Structures</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-storing-data-for-parsing"><div class="pe-1">3.6.</div><div class="text-break">Storing Data for Parsing</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-connecting-structures-with-"><div class="pe-1">3.7.</div><div class="text-break">Connecting Structures with Functions</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-specifying-protocols"><div class="pe-1">3.8.</div><div class="text-break">Specifying Protocols</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-importing-definitions-from-"><div class="pe-1">3.9.</div><div class="text-break">Importing Definitions from Other Documents</div></a></nav><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-design-principles"><div class="pe-1">4.</div><div class="text-break">Design Principles</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-iana-considerations"><div class="pe-1">5.</div><div class="text-break">IANA Considerations</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-security-considerations"><div class="pe-1">6.</div><div class="text-break">Security Considerations</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-acknowledgements"><div class="pe-1">7.</div><div class="text-break">Acknowledgements</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-informative-references"><div class="pe-1">8.</div><div class="text-break">Informative References</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-abnf-specification"><div class="pe-1">A.</div><div class="text-break">ABNF specification</div></a><nav class="nav-pills ps-3 flex-column"><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-constraint-expressions"><div class="pe-1">A.1.</div><div class="text-break">Constraint Expressions</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-augmented-packet-diagrams"><div class="pe-1">A.2.</div><div class="text-break">Augmented packet diagrams</div></a></nav><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-tooling-source-code"><div class="pe-1">B.</div><div class="text-break">Tooling &amp; source code</div></a><a class="nav-link ps-1 d-flex hyphenate py-0" href="#name-authors-addresses"><div class="text-break">Authors' Addresses</div></a></nav>
                            </div>
                            <div class="tab-pane mb-5 small" id="pref-tab-pane" role="tabpanel" aria-labelledby="pref-tab" tabindex="0">
                                <label class="form-label fw-bold mb-2">Show sidebar by default</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="sidebar" id="on-radio">
                                    <label class="btn btn-outline-primary" for="on-radio">Yes</label>
                                    <input type="radio" class="btn-check" name="sidebar" id="off-radio">
                                    <label class="btn btn-outline-primary" for="off-radio">No</label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">Tab to show by default</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="deftab" id="docinfo-radio" checked="checked">
                                    <label class="btn btn-outline-primary" for="docinfo-radio">
                                        <i class="bi bi-info-circle me-1"></i>Info
                                    </label>
                                    <input type="radio" class="btn-check" name="deftab" id="toc-radio">
                                    <label class="btn btn-outline-primary" for="toc-radio">
                                        <i class="bi bi-list-ol me-1"></i>Contents
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">HTMLization configuration</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="htmlconf" id="txt-radio">
                                    <label class="btn btn-outline-primary" for="txt-radio" data-bs-original-title="This is the traditional HTMLization method.">
                                        <i class="bi bi-badge-sd me-1"></i>HTMLize the plaintext
                                    </label>
                                    <input type="radio" class="btn-check" name="htmlconf" id="html-radio">
                                    <label class="btn btn-outline-primary" for="html-radio" data-bs-original-title="This is the modern HTMLization method.">
                                        <i class="bi bi-badge-hd me-1"></i>Plaintextify the HTML
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2" for="ptsize">Maximum font size</label>
                                <input type="range" class="form-range" min="7" max="16" id="ptsize" oninput="ptdemo.value = ptsize.value" value="12">
                                <label class="form-label fw-bold mt-4 mb-2">Page dependencies</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="pagedeps" id="inline-radio">
                                    <label class="btn btn-outline-primary" for="inline-radio" data-bs-original-title="Generate larger, standalone web pages that do not require network access to render.">
                                        <i class="bi bi-box me-1"></i>Inline
                                    </label>
                                    <input type="radio" class="btn-check" name="pagedeps" id="reference-radio">
                                    <label class="btn btn-outline-primary" for="reference-radio" data-bs-original-title="Generate regular web pages that require network access to render.">
                                        <i class="bi bi-link-45deg me-1"></i>Reference
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">Citation links</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="reflinks" id="refsection-radio" checked="checked">
                                    <label class="btn btn-outline-primary" for="refsection-radio" data-bs-original-title="Citation links go to the reference section.">
                                        <i class="bi bi-arrow-clockwise"></i> Go to reference section
                                    </label>
                                    <input type="radio" class="btn-check" name="reflinks" id="citation-radio">
                                    <label class="btn btn-outline-primary" for="citation-radio" data-bs-original-title="Citation links go directly to the cited document.">
                                        <i class="bi bi-link-45deg me-1"></i>Go to linked document
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
<script type="text/javascript">
  var _paq = window._paq || [];
  
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.ietf.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', 7]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//analytics.ietf.org/piwik.php?idsite=7" style="border:0;" alt="" /></p></noscript>

    <script>(function(){var js = "window['__CF$cv$params']={r:'81d89775087f50a8',t:'MTY5ODU1Mjg2Ni41MzEwMDA='};_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: medium; visibility: hidden;"></iframe>

<div class="tooltip bs-tooltip-auto fade show" role="tooltip" id="tooltip285844" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate(846px, 22910px);" data-popper-placement="top"><div class="tooltip-arrow" style="position: absolute; left: 0px; transform: translate(59px);"></div><div class="tooltip-inner">Table of contents</div></div></body></html>